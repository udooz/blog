
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>.NET-Sploit: Exploit .NET Framework - Udooz!</title>
  <meta name="author" content="M Sheik Uduman Ali">

  
  <meta name="description" content="Though it is an uncommon attack, but it highlights the backdoor of Virtual Machine such as .NET, JVM. Rootkit is a system which consists of programs &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://udooz.github.io//blog/2009/04/net-sploit-exploit-net-framework/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Udooz!" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:udooz.github.io//blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/blog/">
        <span class="blue_light">
            Udooz!
        </span>
       
           <span class="blue_dark">
             technologies.each { |tech| write_post(tech.facets) if tech.facets
           </span>
       
    </a></li>
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
  <li><a href="/blog/about">About me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">.NET-Sploit: Exploit .NET Framework</h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-21T00:00:00+05:30" pubdate data-updated="true"></time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Though it is an uncommon attack, but it highlights the backdoor of Virtual Machine such as .NET, JVM.</p>

<blockquote><p>Rootkit is a system which consists of programs designed to hide or obscure the fact that a system has been compromised.  &#8211; Wikipedia</p></blockquote>

<p> .NET-Sploit is a tool which is used to build MSIL rootkit that enables the user to inject malicious behavior to the framework DLLs (See the following picture).  The only challenge for the hacker is to compromise the particular system with administrator rights.</p>

<p><img class="alignnone size-full wp-image-87" title="dnet_rootkit" src="http://udooz.github.io//blog/images/2009/04/dnet_rootkit.png" alt="dnet_rootkit" width="405" height="203" /></p>

<p><strong>What does it actually mean?</strong></p>

<p>After the compromising a target system, a hacker can modify .NET framework DLL those are normally located in GAC by assembling and dessembling with regular .NET tools.  This approach does not need to touch .NET applications.  All the application invoke required tampered framework DLLs which will behave strangely.  For example, using the rootkit, you can always print &#8220;Hacked&#8221; message in</p>

<p>irrespective of any string value.  Worst part is, if a hacker is tampered  &#8220;Authenticate()&#8221; in System.Web.dll and he can capture the username and password.  Ofcourse, he can send the details to someone else using SendToUrl().</p>

<p> </p>

<p><strong>What can you do with framework rootkit?</strong></p>

<ul>
<li>API hooking</li>
<li>Method code modification</li>
<li>Method parameter manipulation</li>
<li>Object member manipulation</li>
<li>Exe dynamic forking</li>
<li>Metada tampering</li>
<li>Return value modification</li>
</ul>


<p><strong>How is it possible?</strong></p>

<p>Manually you can attack the framework by the following steps:</p>

<ol>
<li>Locate DLL in the GAC</li>
<li>Decompile the DLL (using ILDASM)</li>
<li>Modify the IL code</li>
<li>Recompile to a new DLL (new version!)</li>
<li>Bypass the GAC strong name protection (very simple than expected)</li>
<li>Override the existing DLL with new one.</li>
</ol>


<blockquote><p> A surprising fact is GAC does not perform any additional check for verifying strong name of a DLL when coping the modified framework DLL into the actual folder path.  For example, you can modify mscorlib.dll version 2.0 and place it  into c:\WINDOWS\assembly\GAC_32\mscorlib\2.0.0.0__b77a5c561934e089.</p></blockquote>

<p><strong>What is .NET-Sploit?</strong></p>

<p>A generic framework modification tool to inject code.  You can download at <a href="http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx" target="_blank"><a href="http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx">http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx</a></a>.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">udooz</span></span>

      








  


<time datetime="2009-04-21T00:00:00+05:30" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/blog/blog/categories/dot-net/'>.net</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://udooz.github.io//blog/2009/04/net-sploit-exploit-net-framework/" data-via="udooz" data-counturl="http://udooz.github.io//blog/2009/04/net-sploit-exploit-net-framework/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2009/04/clr-improvements-in-net-35-sp1/" title="Previous Post: CLR Improvements in .NET 3.5 SP1">&laquo; CLR Improvements in .NET 3.5 SP1</a>
      
      
        <a class="basic-alignment right" href="/blog/2009/04/aspnet-extender-control-decorating-web-controls/" title="Next Post: ASP.NET Extender Control: Decorating &#038; Componentizing Web Controls With Client Behavior">ASP.NET Extender Control: Decorating &#038; Componentizing Web Controls With Client Behavior &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/06/dont-use-elephant-for-your-garden-work/">Don&#8217;t use elephant for your garden work</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/unpacking-apache-storm-in-developer-box/">Unpacking Apache Storm in developer box</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/book-review-heroku-up-and-running-by-neil-richard-oreilly/">Book Review &#8211; Heroku up and running by Neil &#038; Richard &#8211; O&#8217;Reilly</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/book-review-see-what-i-mean-oreilly/">Book Review &#8211; See What I Mean &#8211; O&#8217;Reilly</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/adopting-event-sourcing-in-saas-using-windows-azure/">Adopting Event Sourcing in SaaS using Windows Azure</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - M Sheik Uduman Ali -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'udooz';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
