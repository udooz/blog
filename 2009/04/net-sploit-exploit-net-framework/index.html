
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>.NET-Sploit: Exploit .NET Framework - Udooz!</title>
  <meta name="author" content="M Sheik Uduman Ali">

  
  <meta name="description" content="Tweet .NET-Sploit: Exploit .NET Framework Though it is an uncommon attack, but it highlights the backdoor of Virtual Machine such as .NET, JVM. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://udooz.github.io//blog/2009/04/net-sploit-exploit-net-framework/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Udooz!" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body >
  <header role="banner" id="sidebar">
    <!-- Logo -->
<aside id="logo" class="clearfix">
  <div class="clearfix">
    <a href="/blog/">Udooz!</a>
  </div>
</aside>

<ul id="menu">

  <li class="title">
    <h1 id="title"><a href="/blog/">Udooz!</a></h1>
  </li>


  <li class="subtitle">
    <h2 id="subtitle">technologies.each { |tech| write_post(tech.facets) if tech.facets</h2>
  </li>

  <li class="link">
    <a href="/about/">about</a>
  </li>


  <li class="link rss">
    <a href="/atom.xml">rss feed</a>
  </li>
</ul>


<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:udooz.github.io//blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>


<!-- Octopress Love -->
<aside id="octopress_linkback">
  <a href="http://octopress.org/">
    <span class="unicode_square">
      <span class="unicode_circle">
        &nbsp;
      </span>
    </span>
    <span class="octopress">Powered by Octopress</span>
  </a>
</aside>

  </header>
  <section id="main">
    <article class="post">
  <div class="sharing-box">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://udooz.github.io//blog/2009/04/net-sploit-exploit-net-framework/" data-via="" data-counturl="http://udooz.github.io//blog/2009/04/net-sploit-exploit-net-framework/" data-size="large">Tweet</a>
  
  
  
</div>

  
  <header>
    
      <h2 class="entry-title">.NET-Sploit: Exploit .NET Framework</h2>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-21T00:00:00+05:30" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


<p>Though it is an uncommon attack, but it highlights the backdoor of Virtual Machine such as .NET, JVM.</p>

<blockquote><p>Rootkit is a system which consists of programs designed to hide or obscure the fact that a system has been compromised.  &#8211; Wikipedia</p></blockquote>

<p> .NET-Sploit is a tool which is used to build MSIL rootkit that enables the user to inject malicious behavior to the framework DLLs (See the following picture).  The only challenge for the hacker is to compromise the particular system with administrator rights.</p>

<p><img class="alignnone size-full wp-image-87" title="dnet_rootkit" src="http://udooz.github.io//blog/images/2009/04/dnet_rootkit.png" alt="dnet_rootkit" width="405" height="203" /></p>

<p><strong>What does it actually mean?</strong></p>

<p>After the compromising a target system, a hacker can modify .NET framework DLL those are normally located in GAC by assembling and dessembling with regular .NET tools.  This approach does not need to touch .NET applications.  All the application invoke required tampered framework DLLs which will behave strangely.  For example, using the rootkit, you can always print &#8220;Hacked&#8221; message in</p>

<p>irrespective of any string value.  Worst part is, if a hacker is tampered  &#8220;Authenticate()&#8221; in System.Web.dll and he can capture the username and password.  Ofcourse, he can send the details to someone else using SendToUrl().</p>

<p> </p>

<p><strong>What can you do with framework rootkit?</strong></p>

<ul>
<li>API hooking</li>
<li>Method code modification</li>
<li>Method parameter manipulation</li>
<li>Object member manipulation</li>
<li>Exe dynamic forking</li>
<li>Metada tampering</li>
<li>Return value modification</li>
</ul>


<p><strong>How is it possible?</strong></p>

<p>Manually you can attack the framework by the following steps:</p>

<ol>
<li>Locate DLL in the GAC</li>
<li>Decompile the DLL (using ILDASM)</li>
<li>Modify the IL code</li>
<li>Recompile to a new DLL (new version!)</li>
<li>Bypass the GAC strong name protection (very simple than expected)</li>
<li>Override the existing DLL with new one.</li>
</ol>


<blockquote><p> A surprising fact is GAC does not perform any additional check for verifying strong name of a DLL when coping the modified framework DLL into the actual folder path.  For example, you can modify mscorlib.dll version 2.0 and place it  into c:\WINDOWS\assembly\GAC_32\mscorlib\2.0.0.0__b77a5c561934e089.</p></blockquote>

<p><strong>What is .NET-Sploit?</strong></p>

<p>A generic framework modification tool to inject code.  You can download at <a href="http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx" target="_blank"><a href="http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx">http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx</a></a>.</p>



</article>


    <nav role="navigation" id="pagination">

</nav>
  </section>
  

  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
