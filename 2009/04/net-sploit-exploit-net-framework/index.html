
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>.NET-Sploit: Exploit .NET Framework - Udooz!</title>
    <meta name="author" content="M Sheik Uduman Ali">
    
	<meta name="description" content="Though it is an uncommon attack, but it highlights the backdoor of Virtual Machine such as .NET, JVM. Rootkit is a system which consists of programs &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Udooz!" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/blog/favicon.ico" rel="shortcut icon">
    <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <script type="text/javascript" src="/blog/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <script src="/javascripts/ajaxify.js"></script>
   
    
    

</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        Udooz!
    </div>
</h1>
<br>

<ul id="social-links" style="text-align:center">
  
  
  
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/blog/index.html">Home</a></li>
	<li id="ajax"><a href="/blog/blog/archives/index.html">Archives</a></li>
    <li><a href="/blog/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form method="get" action="/blog/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload --> 
    <div id="content" class="inner">
        <article class="post">
	<h2 class="title">.NET-Sploit: Exploit .NET Framework</h2>
	<div class="entry-content"><p>Though it is an uncommon attack, but it highlights the backdoor of Virtual Machine such as .NET, JVM.</p>

<blockquote><p>Rootkit is a system which consists of programs designed to hide or obscure the fact that a system has been compromised.  &#8211; Wikipedia</p></blockquote>

<p> .NET-Sploit is a tool which is used to build MSIL rootkit that enables the user to inject malicious behavior to the framework DLLs (See the following picture).  The only challenge for the hacker is to compromise the particular system with administrator rights.</p>

<p><img class="alignnone size-full wp-image-87" title="dnet_rootkit" src="http://udooz.github.io//blog/images/2009/04/dnet_rootkit.png" alt="dnet_rootkit" width="405" height="203" /></p>

<p><strong>What does it actually mean?</strong></p>

<p>After the compromising a target system, a hacker can modify .NET framework DLL those are normally located in GAC by assembling and dessembling with regular .NET tools.  This approach does not need to touch .NET applications.  All the application invoke required tampered framework DLLs which will behave strangely.  For example, using the rootkit, you can always print &#8220;Hacked&#8221; message in</p>

<p>irrespective of any string value.  Worst part is, if a hacker is tampered  &#8220;Authenticate()&#8221; in System.Web.dll and he can capture the username and password.  Ofcourse, he can send the details to someone else using SendToUrl().</p>

<p> </p>

<p><strong>What can you do with framework rootkit?</strong></p>

<ul>
<li>API hooking</li>
<li>Method code modification</li>
<li>Method parameter manipulation</li>
<li>Object member manipulation</li>
<li>Exe dynamic forking</li>
<li>Metada tampering</li>
<li>Return value modification</li>
</ul>


<p><strong>How is it possible?</strong></p>

<p>Manually you can attack the framework by the following steps:</p>

<ol>
<li>Locate DLL in the GAC</li>
<li>Decompile the DLL (using ILDASM)</li>
<li>Modify the IL code</li>
<li>Recompile to a new DLL (new version!)</li>
<li>Bypass the GAC strong name protection (very simple than expected)</li>
<li>Override the existing DLL with new one.</li>
</ol>


<blockquote><p> A surprising fact is GAC does not perform any additional check for verifying strong name of a DLL when coping the modified framework DLL into the actual folder path.  For example, you can modify mscorlib.dll version 2.0 and place it  into c:\WINDOWS\assembly\GAC_32\mscorlib\2.0.0.0__b77a5c561934e089.</p></blockquote>

<p><strong>What is .NET-Sploit?</strong></p>

<p>A generic framework modification tool to inject code.  You can download at <a href="http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx" target="_blank"><a href="http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx">http://www.applicationsecurity.co.il/english/NETFrameworkRootkits/tabid/161/Default.aspx</a></a>.</p>
</div>

<div class="meta">
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2014

    M Sheik Uduman Ali
. Powered by <a href="http://octopress.org">Octopress</a> | 
    Theme <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/blog/javascripts/fabric.js"></script>
<script src="/blog/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
