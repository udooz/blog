
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>NGen &#8211; Helpful or Harmful - Udooz!</title>
  <meta name="author" content="M Sheik Uduman Ali">

  
  <meta name="description" content="Tweet NGen &#8211; Helpful or Harmful What is NGen? A tool comes with .NET framework, which is used to generate native image of a managed assembly &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://udooz.github.io//blog/2009/03/ngen-helpful-or-harmful/">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="/blog/javascripts/ender.js"></script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Udooz!" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body >
  <header role="banner" id="sidebar">
    <!-- Logo -->
<aside id="logo" class="clearfix">
  <div class="clearfix">
    <a href="/blog/">Udooz!</a>
  </div>
</aside>

<ul id="menu">

  <li class="title">
    <h1 id="title"><a href="/blog/">Udooz!</a></h1>
  </li>


  <li class="subtitle">
    <h2 id="subtitle">technologies.each { |tech| write_post(tech.facets) if tech.facets</h2>
  </li>

  <li class="link">
    <a href="/about/">about</a>
  </li>


  <li class="link rss">
    <a href="/atom.xml">rss feed</a>
  </li>
</ul>


<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:udooz.github.io//blog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>


<!-- Octopress Love -->
<aside id="octopress_linkback">
  <a href="http://octopress.org/">
    <span class="unicode_square">
      <span class="unicode_circle">
        &nbsp;
      </span>
    </span>
    <span class="octopress">Powered by Octopress</span>
  </a>
</aside>

  </header>
  <section id="main">
    <article class="post">
  <div class="sharing-box">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://udooz.github.io//blog/2009/03/ngen-helpful-or-harmful/" data-via="" data-counturl="http://udooz.github.io//blog/2009/03/ngen-helpful-or-harmful/" data-size="large">Tweet</a>
  
  
  
</div>

  
  <header>
    
      <h2 class="entry-title">NGen &#8211; Helpful or Harmful</h2>
    
    
      <p class="meta">
        








  


<time datetime="2009-03-06T00:00:00+05:30" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


<p><strong>What is NGen?</strong></p>

<p>A tool comes with .NET framework, which is used to generate native image of a managed assembly.  </p>

<p>The managed assemblies (.dll and .exe)  contain IL code that are not understandable by native operation system.  When executing the managed application, JIT compiler  compiles the IL code into native code.  This would require some amount of memory for JIT compiler and the application takes some time on start-up. </p>

<p>NGen provides pre-compilation option so that you can compile your application IL code into native code one shot before starting the application itself.  The .NET framework libraries, Paint.NET are some applications use NGen.</p>

<p><strong>How it works?</strong></p>

<p>NGen invokes &#8220;Compilation Worker&#8221; when you give a managed assembly for native code generation.  Compilation Worker loads runtime and uses JIT compiler to create native code.  It places the JIT generated native code into the assembly cache in a file with name &#8220;YourAssemblyName.ni.dll&#8221;.  This file is generally called as &#8220;native image&#8221;.  The cache folder path is %Windows%\Assembly\NativeImages_v2.0.50727_32.  When you run the application, CLR finds the native image of an assembly and executes it, if the assembly exists on cache; otherwise it does normal path.</p>

<p><strong>Advantages</strong></p>

<ul>
<li>Lesser application start-up time.  Since compilation and module load are not required for native image.</li>
<li>Sharable. The NGen generated native image contains memory base address details so that once an assembly is loaded into memory it can directly be usable by another applications those require the specific assembly.</li>
</ul>


<p><strong>Is It Value-Add?</strong></p>

<p>The advantages make us very happy after all we are the guys working behind virtual machines a.k.a CLR.  However, you cannot write a single rule of thumb for NGen usage.  Using NGen is varied based on the situation or requirement.  One rule of thumb for NGen would be:</p>

<blockquote><p>Do not use native images for server side applications.  The assemblies for a server side applications are loaded and JITted only once at the first time of request.  For succeeding requests, the JIT compiled codes are executed.  So, there is no benefit using NGen on server side application.</p></blockquote>

<p>Consider the following for client side applications before decide to use NGen:</p>

<ul>
<li>NGen is not so smart to load native image for a managed assembly.  CLR gets fail to load native image, if it finds assembly version, CPU and CLR version mismatch.</li>
<li>The native code generated using NGen are not purely optimized for underlying environment in compare with JIT compilation.  JIT compiler generates more optimized code for the target environment.</li>
<li>NGen generated codes typically contain base address which may results more process consumption if the particular base address is already claimed by another application.  Despite C# compiler&#8217;s &#8220;/baseaddress&#8221; option may fix this issue, however a smart way need to be applied which is most of the time not considered. Simply, sharable nature of native image is not consistent.</li>
</ul>


<p>So, &#8220;Think twice before NGen&#8221; for client side applications.</p>



</article>


    <nav role="navigation" id="pagination">

</nav>
  </section>
  

  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
