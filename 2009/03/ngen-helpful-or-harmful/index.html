
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>NGen &#8211; Helpful or Harmful - Udooz!</title>
    <meta name="author" content="M Sheik Uduman Ali">
    
	<meta name="description" content="What is NGen? A tool comes with .NET framework, which is used to generate native image of a managed assembly.   The managed assemblies (.dll and .exe &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Udooz!" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/blog/favicon.ico" rel="shortcut icon">
    <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <script type="text/javascript" src="/blog/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <script src="/javascripts/ajaxify.js"></script>
   
    
    

</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        Udooz!
    </div>
</h1>
<br>

<ul id="social-links" style="text-align:center">
  
  
  
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/blog/index.html">Home</a></li>
	<li id="ajax"><a href="/blog/blog/archives/index.html">Archives</a></li>
    <li><a href="/blog/atom.xml">RSS</a></li>
    
    <li>
    <div id="dark">
        <form method="get" action="/blog/search.html" id="search">
            <input name="query" type="text" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload --> 
    <div id="content" class="inner">
        <article class="post">
	<h2 class="title">NGen &#8211; Helpful or Harmful</h2>
	<div class="entry-content"><p><strong>What is NGen?</strong></p>

<p>A tool comes with .NET framework, which is used to generate native image of a managed assembly.  </p>

<p>The managed assemblies (.dll and .exe)  contain IL code that are not understandable by native operation system.  When executing the managed application, JIT compiler  compiles the IL code into native code.  This would require some amount of memory for JIT compiler and the application takes some time on start-up. </p>

<p>NGen provides pre-compilation option so that you can compile your application IL code into native code one shot before starting the application itself.  The .NET framework libraries, Paint.NET are some applications use NGen.</p>

<p><strong>How it works?</strong></p>

<p>NGen invokes &#8220;Compilation Worker&#8221; when you give a managed assembly for native code generation.  Compilation Worker loads runtime and uses JIT compiler to create native code.  It places the JIT generated native code into the assembly cache in a file with name &#8220;YourAssemblyName.ni.dll&#8221;.  This file is generally called as &#8220;native image&#8221;.  The cache folder path is %Windows%\Assembly\NativeImages_v2.0.50727_32.  When you run the application, CLR finds the native image of an assembly and executes it, if the assembly exists on cache; otherwise it does normal path.</p>

<p><strong>Advantages</strong></p>

<ul>
<li>Lesser application start-up time.  Since compilation and module load are not required for native image.</li>
<li>Sharable. The NGen generated native image contains memory base address details so that once an assembly is loaded into memory it can directly be usable by another applications those require the specific assembly.</li>
</ul>


<p><strong>Is It Value-Add?</strong></p>

<p>The advantages make us very happy after all we are the guys working behind virtual machines a.k.a CLR.  However, you cannot write a single rule of thumb for NGen usage.  Using NGen is varied based on the situation or requirement.  One rule of thumb for NGen would be:</p>

<blockquote><p>Do not use native images for server side applications.  The assemblies for a server side applications are loaded and JITted only once at the first time of request.  For succeeding requests, the JIT compiled codes are executed.  So, there is no benefit using NGen on server side application.</p></blockquote>

<p>Consider the following for client side applications before decide to use NGen:</p>

<ul>
<li>NGen is not so smart to load native image for a managed assembly.  CLR gets fail to load native image, if it finds assembly version, CPU and CLR version mismatch.</li>
<li>The native code generated using NGen are not purely optimized for underlying environment in compare with JIT compilation.  JIT compiler generates more optimized code for the target environment.</li>
<li>NGen generated codes typically contain base address which may results more process consumption if the particular base address is already claimed by another application.  Despite C# compiler&#8217;s &#8220;/baseaddress&#8221; option may fix this issue, however a smart way need to be applied which is most of the time not considered. Simply, sharable nature of native image is not consistent.</li>
</ul>


<p>So, &#8220;Think twice before NGen&#8221; for client side applications.</p>
</div>

<div class="meta">
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2014

    M Sheik Uduman Ali
. Powered by <a href="http://octopress.org">Octopress</a> | 
    Theme <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/blog/javascripts/fabric.js"></script>
<script src="/blog/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
